<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Ads API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
        }

        .container {
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
        }

        button {
            background-color: #4285f4;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }

        button:hover {
            background-color: #357abd;
        }

        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 4px;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }

        .error {
            background-color: #ffebee;
            color: #c62828;
        }

        .success {
            background-color: #e8f5e8;
            color: #2e7d32;
        }

        .loading {
            background-color: #fff3e0;
            color: #f57c00;
        }

        .campaign-item {
            border: 1px solid #ddd;
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
            background-color: white;
        }

        .campaign-name {
            font-weight: bold;
            color: #1976d2;
        }

        .campaign-details {
            margin-top: 5px;
            font-size: 14px;
            color: #666;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Google Ads API Test</h1>

        <p>Bu test, Google Ads API'ye bağlanıp kampanya listesini çekecektir.</p>

        <button onclick="testGoogleAdsAPI()" id="testBtn">Google Ads API'yi Test Et</button>

        <div id="result" class="result" style="display: none;"></div>
    </div>

    <script>
        async function testGoogleAdsAPI() {
            const testBtn = document.getElementById('testBtn');
            const resultDiv = document.getElementById('result');

            // Loading durumu
            testBtn.disabled = true;
            testBtn.textContent = 'Test ediliyor...';
            resultDiv.innerHTML = 'Google Ads API\'ye bağlanılıyor...';
            resultDiv.style.display = 'block';
            resultDiv.className = 'result loading';

            try {
                const response = await fetch('/api/google-ads/test');
                const data = await response.json();

                if (response.ok && data.success) {
                    // Başarılı sonuç
                    let html = `<strong>✅ Başarılı!</strong>\n\n`;
                    html += `Toplam Kampanya Sayısı: ${data.data.totalCampaigns}\n\n`;

                    if (data.data.campaigns.length > 0) {
                        html += '<strong>Kampanyalar:</strong>\n';
                        data.data.campaigns.forEach(campaign => {
                            html += `
                                <div class="campaign-item">
                                    <div class="campaign-name">${campaign.name}</div>
                                    <div class="campaign-details">
                                        ID: ${campaign.id} | Durum: ${campaign.status} | Bütçe: ${campaign.budgetAmount}
                                        ${campaign.startDate ? ` | Başlangıç: ${campaign.startDate}` : ''}
                                        ${campaign.endDate ? ` | Bitiş: ${campaign.endDate}` : ''}
                                    </div>
                                </div>
                            `;
                        });
                    } else {
                        html += 'Henüz kampanya bulunmuyor.\n';
                    }

                    html += `\n<strong>Ham Yanıt:</strong>\n${JSON.stringify(data.data.rawResponse, null, 2)}`;

                    resultDiv.innerHTML = html;
                    resultDiv.className = 'result success';
                } else {
                    // Hata durumu
                    let html = `<strong>❌ Hata!</strong>\n\n`;
                    html += `Hata: ${data.error}\n`;

                    if (data.details) {
                        html += `\nDetaylar:\n${JSON.stringify(data.details, null, 2)}`;
                    }

                    resultDiv.innerHTML = html;
                    resultDiv.className = 'result error';
                }
            } catch (error) {
                resultDiv.innerHTML = `<strong>❌ Network Hatası!</strong>\n\n${error.message}`;
                resultDiv.className = 'result error';
            } finally {
                // Button'u eski haline getir
                testBtn.disabled = false;
                testBtn.textContent = 'Google Ads API\'yi Test Et';
            }
        }
    </script>
</body>

</html>